!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e="undefined"!=typeof globalThis?globalThis:e||self).TimerManager=r()}(this,function(){"use strict";class e{constructor(e="/shared-timer-worker.js"){this.worker=null,this.workerPath=e,this.callbacks=new Map,this.isConnected=!1,this.init()}init(){try{this.worker=new SharedWorker(this.workerPath),this.worker.port.start(),this.worker.port.onmessage=e=>{this.handleWorkerMessage(e.data)},this.worker.port.onerror=e=>{console.error("SharedWorker error:",e)},this.isConnected=!0}catch(e){throw console.error("Failed to initialize SharedWorker:",e),new Error("SharedWorker not supported or failed to initialize")}}handleWorkerMessage(e){const{action:r,taskName:t,timestamp:o}=e;switch(r){case"TIMER_TICK":const e=this.callbacks.get(t);e&&e(t,o);break;case"TASK_CLEARED":break;case"ALL_TASKS_CLEARED":this.callbacks.clear()}}addTimerTask(e,r,t,o=!0){if(!this.isConnected)throw new Error("TimerManager is not connected to SharedWorker");if("function"!=typeof t)throw new Error("Callback must be a function");if("number"!=typeof r||r<=0)throw new Error("Interval time must be a positive number");this.callbacks.set(e,t),this.worker.port.postMessage({action:"ADD_TASK",taskName:e,intervalTime:r,canRepeat:o})}clearTimerTask(e){if(!this.isConnected)throw new Error("TimerManager is not connected to SharedWorker");this.callbacks.delete(e),this.worker.port.postMessage({action:"CLEAR_TASK",taskName:e})}removeAllTimerTasks(){if(!this.isConnected)throw new Error("TimerManager is not connected to SharedWorker");this.callbacks.clear(),this.worker.port.postMessage({action:"REMOVE_ALL"})}ping(e="health-check"){return!!this.isConnected&&(this.worker.port.postMessage({action:"PING",taskName:e}),!0)}getActiveTasks(){return Array.from(this.callbacks.keys())}hasTask(e){return this.callbacks.has(e)}}return"undefined"!=typeof module&&module.exports&&(module.exports=e),e});
//# sourceMappingURL=timer-manager.min.js.map
